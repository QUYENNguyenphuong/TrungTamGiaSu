YUI.add("photo-list-subview",function(e,t){var r=require("hermes-core/type-validator"),o=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.PhotoListSubview=e.Base.create(this.name,e.FlickrView,[],{downloadCacheAndSetImage:function(){e.fluid.loadImage(this.get("photoUrl"),{timeout:1e3,retry:!0}).then(function(e){this.handleImageLoad(!0,e)}.bind(this),function(e){this.handleImageLoad(!1,e+"?retry="+Date.now())}.bind(this))},handleImageLoad:function(t,r){var o=this.get("photoContainer");o.setStyle("backgroundImage","url("+r+")"),t||o.setStyle("backgroundColor","#eee"),this.get("model").getValue("needsInterstitial")&&o.addClass("restricted-image"),e.fluid.chill(function(){this.fire(t?"loaded":"loadError")},this)},updateGeometry:function(e){e?this.set("layoutItem",e):e=this.get("layoutItem"),this.updateNodeGeometry(e,this.get("container"))},updateNodeGeometry:function(t,r){YUI.Env.isServer?r.setStyles({transform:"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-webkit-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)","-ms-transform":"translate("+t.geometry.left+"px, "+t.geometry.top+"px)"}):e.fluid.setStylePrefixed("transform","translate("+t.geometry.left+"px, "+t.geometry.top+"px)",r),t.forcedAspectRatio&&r.addClass("forced-aspect-ratio"),r.setStyles({width:t.geometry.width+"px",height:t.geometry.height+"px"})}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(e,t){return r.photoId(e)}},layoutItem:{validator:function(e,t){return"object"==typeof e&&e.hasOwnProperty("aspectRatio")&&e.hasOwnProperty("geometry")&&"object"==typeof e.geometry&&e.geometry.hasOwnProperty("width")&&e.geometry.hasOwnProperty("height")&&e.geometry.hasOwnProperty("top")&&e.geometry.hasOwnProperty("left")&&e.hasOwnProperty("isAwake")}},listModelParams:{writeOnce:"initOnly"},photoUrl:{value:"/images/spaceball.gif",getter:function(e,t){var r=this.get("model"),o=this.get("layoutItem");return r.getSizeToFit({width:o.geometry.width*this.get("photoContainerSize"),height:o.geometry.height*this.get("photoContainerSize")},{includeSquare:!1}).url}},linkedPageUrl:{writeOnce:!0,validator:function(t,r){return e.AttributeHelpers.validateString(t)}},model:{value:null},photoContainer:{readOnly:!0,derivedBy:["container"],getter:function(e){return YUI.Env.isServer?(o.warn("Cannot access photoContainer on the server; set values in the template instead. Falling back to view container."),this.get("container")):this.get("container").one(".photo")}},photoContainerSize:{value:1},measureAFT:{value:!1,validator:function(t,r){return e.AttributeHelpers.validateBoolean(t)}}}})},"@VERSION@",{requires:["flickr-view","attribute-helpers"],optionalRequires:["fluid"]});YUI.add("hermes-template-photo-list-description",function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,a,t){return" restricted-image"},3:function(n,e,l,a,t){return" is-video"},5:function(n,e,l,a,t){return" has-descriptions"},7:function(n,e,l,a,t){var i;return'<div class="description" title="'+n.escapeExpression(n.lambda(null!=(i=null!=e?e.photo:e)?i.description:i,e))+'">\n\t'+(null!=(i=l.if.call(null!=e?e:{},null!=(i=null!=e?e.photo:e)?i.description:i,{name:"if",hash:{},fn:n.program(8,t,0),inverse:n.noop,data:t}))?i:"")+"\n</div>\n"},8:function(n,e,l,a,t){var i;return"<p>"+n.escapeExpression((l.photoDescription||e&&e.photoDescription||l.helperMissing).call(null!=e?e:{},null!=(i=null!=e?e.photo:e)?i.description:i,!0,{name:"photoDescription",hash:{},data:t}))+"</p>"},compiler:[7,">= 4.0.0"],main:function(n,e,l,a,t){var i,o,r=null!=e?e:{},s=l.helperMissing,p=n.escapeExpression;return'<a href="'+p("function"==typeof(o=null!=(o=l.linkedPageUrl||(null!=e?e.linkedPageUrl:e))?o:s)?o.call(r,{name:"linkedPageUrl",hash:{},data:t}):o)+'"><div class="photo'+(null!=(i=l.if.call(r,null!=(i=null!=e?e.photo:e)?i.needsInterstitial:i,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t}))?i:"")+(null!=(i=l.if.call(r,null!=(i=null!=e?e.photo:e)?i.isVideo:i,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t}))?i:"")+(null!=(i=l.if.call(r,null!=e?e.displayDescriptions:e,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t}))?i:"")+'" style="background-image: url(\''+p("function"==typeof(o=null!=(o=l.photoUrl||(null!=e?e.photoUrl:e))?o:s)?o.call(r,{name:"photoUrl",hash:{},data:t}):o)+"');\"></div></a>\n"+p((l.outlet||e&&e.outlet||s).call(r,null!=e?e["photo-list-photo-interaction-view"]:e,{name:"outlet",hash:{},data:t}))+"\n"+(null!=(i=l.if.call(r,null!=(i=null!=e?e.photo:e)?i.description:i,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t}))?i:"")},useData:!0}),a={};n.Array.each([],function(e){var l=n.Template.get("hermes/"+e);l&&(a[e]=l)}),n.Template.register("hermes/photo-list-description",function(e,t){return t=t||{},t.partials=t.partials?n.merge(a,t.partials):a,l(e,t)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-list-description-view",function(t){t.namespace("Views")[this.name]=t.Base.create(this.name,t.PhotoListSubview,[],{langBundles:this.details.langBundles,subviewConfig:{"photo-list-photo-interaction-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},initializer:function(e){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutFaveTest=!0),this.params=e,this.contextifiedPhotoUrl=t.URLHelper.getPhotoPage({photoId:this.get("model").getValue("id"),pathAlias:this.get("model").getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextSuffix")}),e.photoPageUrl=this.contextifiedPhotoUrl,this},loadState:function(){var e=[];return this.set("linkedPageUrl",this.contextifiedPhotoUrl),e.push(this.appContext.getModel(this.get("engagementModelName"),this.get("id"))),t.Promise.all(e).then(function(t){var e=t[0];this.set("engagement",e)}.bind(this))},buildContainer:function(){var t={};return t.linkedPageUrl=this.get("linkedPageUrl"),t.photoUrl=this.get("photoUrl"),t.photo=this.get("model").toJSON(),this.updateGeometry(),YUI.Env.isServer||this.downloadCacheAndSetImage(),this.setContainerWithTemplate("photo-list-description",t),this},activate:function(){return this}},{ATTRS:{contextSuffix:{writeOnce:"initOnly",value:null,validator:function(e,i){return t.AttributeHelpers.validateString(e)}},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(e,i){return t.AttributeHelpers.validateString(e)}}}})},"@VERSION@",{requires:["photo-list-subview","photo-list-photo-interaction-view","hermes-template-photo-list-description","url-helper","attribute-helpers","fluid-modal-view"],optionalRequires:["fluid"],langBundles:["fave-view","common"]});